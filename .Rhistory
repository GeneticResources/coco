stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.29)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
hist(res_preparation)
hist(res_preparation, breaks=100)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
res_preparation[,1]
res_preparation[,2]
res_preparation[,32]
res_preparation[,]
res_preparation[,3]
res_preparation[,]
-1.403067e-02/0.0203444787
-1.015191e-02/ 0.0172582450
1.088257e-02/0.0186076678
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
a
res_preparation
res_preparation
source('~/Sinai/corrcond/R/corrcond.R')
a
res_preparation
freq_af$b
freq_af$Effect
freq_af$Effect
res_preparation
freq_af$Effect
res_preparation
freq_af$Effect
res_preparation
res_preparation[,2]
res_preparation[,3]
source('~/Sinai/corrcond/R/corrcond.R')
a
res_preparation[,3]
res_preparation[,2]
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
a
res_preparation
res_preparation
freq_af$Effect
freq_af$StdErr
source('~/Sinai/corrcond/R/corrcond.R')
a
a
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
a
source('~/Sinai/corrcond/R/corrcond.R')
prep_dataset_common()
prep_dataset_common
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
res_preparation
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
warnings()
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
stepwise_results
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
1.534058e+04
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
r
r
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
1.529011e-01
109665.99
109665.99 - 3.460208e-01
109665.99 - 3.460208e-01 + 1
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
res_preparation
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
freq_af$StdErr
freq_af$StdErr
res_preparation
freq_af$StdErr
freq_af$StdErr^2
freq_af$StdErr^2
2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2
2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2
2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2 * data_set$n
2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2 * freq_af$TotalSampleSize
2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2 * freq_af$TotalSampleSize
(1.6421 * data_set$n) / 2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2 * freq_af$TotalSampleSize
(1.6421 * freq_af$TotalSampleSize) / 2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2 * freq_af$TotalSampleSize
(1.6421 * freq_af$TotalSampleSize) / (2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2 * freq_af$TotalSampleSize)
(1.6421 * freq_af$TotalSampleSize) / (2*freq_af$af * (1-freq_af$af) * freq_af$StdErr^2 * freq_af$TotalSampleSize)
freq_af$Effect^2
freq_af$Effect^2/freq_af$StdErr^2
5.601111e+00
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
res_preparation
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
res_preparation
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
res_preparation$data_set$neff
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
freq_af$rsid == "rs4475146"
freq_af[freq_af$rsid == "rs4475146",]
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results
colnames(freq_af) =="rs12498742"
(freq_af$rsid) =="rs12498742"
freq_af[(freq_af$rsid) =="rs12498742",]
stepwise_results
ld_matrix[c(302,362),c(302,362)]
-0.23581787 /0.003685499
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/.active-rstudio-document', echo=TRUE)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.02)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results
dim(stepwise_results)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results
write.table(stepwise_results$rsid, file="all_data.txt", quote = F, col.names=F, row.names=F)
getwd()
stepwise_results
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
ld_matrix[c(302,362),c(302,362)]
dim(freq_af)
dim(ld_matrix)
ld_matrix = as.matrix(fread("/Volumes/Elements/paintor_runs/final_regions/6_4:9363105-10773602.LD.EUR.old", header=F))
dim(ld_matrix)
frequencies = read.table("/Volumes/Elements/paintor_runs/final_regions/6_4:9363105-10773602.EUR", header=F)
dim(frequencies)
frequencies$V1 == "rs12498742"
which(frequencies$V1 == "rs12498742")
which(frequencies$ == "rs12498742")
frequencies
which(frequencies$V3== "rs12498742")
ld_matrix[2506,]
ld_matrix[2506]
ld_matrix[2506]
which(frequencies$V3== "rs4475146")
which(frequencies$V3== "rs12498742")
ld_matrix[c(2506,2516),c(2506,2516)]
kottgen_meta_analysis = fread("~/Dunedin/Tony/Metanalysis/data/kottgen_effect_filtered.txt", header=T)
all_af = fread("/Volumes/Elements/ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/all_af.txt", header=F)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
freq_af
which(freq_af$rsid =="rs4475146")
which(freq_af$rsid =="rs12498742")
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0, var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
which(freq_af$rsid =="rs12498742")
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
ld_matrix[c(356,362),c(356,362)]
frequencies
freq_af$pos
freq_af$pos1
freq_af$pos
freq_af$pos
freq_af$pos1 - freq_af$pos
which(freq_af$rsid =="rs12498742")
which(freq_af$rsid =="rs4475146")
ld_matrix[c(356,362),c(356,362)]
ld_matrix[c(356,362),c(356,362)]
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
idxs_with_betas
idxs_with_betas
freq_af[2506,]
dim(freq_af)
which(freq_af$rsid =="rs12498742")
which(freq_af$rsid =="rs12498742")
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
idxs_with_betas
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
ld_matrix = as.matrix(fread("/Volumes/Elements/paintor_runs/final_regions/6_4:9363105-10773602.LD.EUR.old", header=F))
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
which(freq_af$rsid =="rs12498742")
which(freq_af$rsid =="rs12498742")
ld_matrix[c(356,362),c(356,362)]
ld_matrix[c(356,362),c(356,362)]
a = stepwise_conditional_wrapper(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold =1e-5,var_y = 1.6421, ld_noise=0)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0, var_y = 1.6421)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
write.table(stepwise_results$rsid, file="all_data.txt", quote = F, col.names=F, row.names=F)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.5,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.6)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
write.table(stepwise_results$rsid, file="all_data.txt", quote = F, col.names=F, row.names=F)
stepwise_results
stepwise_results$rsid
stepwise_results
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.005)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.005)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.6)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.6)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
dim(ld_matrix)
freq_af$rsid
freq_af$pos
freq_af$rsid
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0, var_y = 1.6421)
df = conditional_from_ids(res_preparation = res_preparation,rsids = c("rs71557308","rs186137462","rs116399700","rs1359231","rs1165178"))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
freq_af[rs16890979,]
freq_af[332,]
freq_af[332,]
freq_af[rs16890979,]
freq_af[332,]
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
ld_matrix[c(356,332),c(356,332)]
stepwise_results
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
stepwise_results
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
freq_af$rsid %in% c("rs12498742","rs16890979")
freq_af[freq_af$rsid %in% c("rs12498742","rs16890979"),]
ld_matrix = as.matrix(fread("/Volumes/Elements/paintor_runs/final_regions/6_4:9363105-10773602.LD.EUR.old", header=F))
frequencies = read.table("/Volumes/Elements/paintor_runs/final_regions/6_4:9363105-10773602.EUR", header=F)
kottgen_meta_analysis = fread("~/Dunedin/Tony/Metanalysis/data/kottgen_effect_filtered.txt", header=T)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
all_af = fread("/Volumes/Elements/ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/all_af.txt", header=F)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
dim(freq_af)
freq_af$Allele1
upper(freq_af$Allele1 )
upper(freq_af$Allele1)
toupper(freq_af$Allele1)
toupper(freq_af$Allele1) == freq_af$a1
ifelse(toupper(freq_af$Allele1) == freq_af$a1, freq_af$Effect, -freq_af$Effect)
freq_af$Effect = ifelse(toupper(freq_af$Allele1) == freq_af$a1, freq_af$Effect, -freq_af$Effect)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.5)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.5)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
toupper(freq_af$Allele1) == freq_af$a1
freq_af[toupper(freq_af$Allele1) == freq_af$a1,]
head(freq_af[toupper(freq_af$Allele1) == freq_af$a1,])
freq_af[toupper(freq_af$Allele1) == freq_af$a1,]
head(freq_af[toupper(freq_af$Allele1) == freq_af$a1,])
head(freq_af[toupper(freq_af$Allele1) == freq_af$a1,])
freq_af[toupper(freq_af$Allele1) == freq_af$a1,]
head(freq_af[toupper(freq_af$Allele1) == freq_af$a1,])
head(freq_af[toupper(freq_af$Allele1) == freq_af$a1,])
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.2)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
write.table(stepwise_results$rsid, file="all_data.txt", quote = F, col.names=F, row.names=F)
write.table(stepwise_results$rsid, file="all_data.txt", quote = F, col.names=F, row.names=F)
source('~/.active-rstudio-document', echo=TRUE)
library(data.table)
ld_matrix = as.matrix(fread("/Volumes/Elements/paintor_runs/final_regions/9_4:88710413-89316460.LD.EUR.old", header=F))
frequencies = read.table("/Volumes/Elements/paintor_runs/final_regions/9_4:88710413-89316460", header=F)
kottgen_meta_analysis = fread("~/Dunedin/Tony/Metanalysis/data/kottgen_effect_filtered.txt", header=T)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
freq_af$Effect = ifelse(toupper(freq_af$Allele1) == freq_af$a1, freq_af$Effect, -freq_af$Effect)
a = stepwise_conditional_wrapper(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold =1e-5,var_y = 1.6421, ld_noise=0)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0, var_y = 1.6421)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
freq_af$Effect = ifelse(toupper(freq_af$Allele1) == freq_af$a1, freq_af$Effect, -freq_af$Effect)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
ld_matrix = as.matrix(fread("/Volumes/Elements/paintor_runs/final_regions/9_4:88710413-89316460.LD.EUR.old", header=F))
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
freq_af$af = as.numeric(freq_af$af)
freq_af
freq_af$AF
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
freq_af
frequencies = read.table("/Volumes/Elements/paintor_runs/final_regions/9_4:88710413-89316460.EUR", header=F)
kottgen_meta_analysis = fread("~/Dunedin/Tony/Metanalysis/data/kottgen_effect_filtered.txt", header=T)
all_af = fread("/Volumes/Elements/ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/all_af.txt", header=F)
all_af = fread("/Volumes/Elements/ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/all_af.txt", header=F)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
freq_af$Effect = ifelse(toupper(freq_af$Allele1) == freq_af$a1, freq_af$Effect, -freq_af$Effect)
dim(freq_af)
dim(ld_matrix)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0, var_y = 1.6421)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.6)
write.table(stepwise_results$rsid, file="all_data.txt", quote = F, col.names=F, row.names=F)
which(freq_af$rsid == "rs2622629")
ld_matrix[399,395]
ource("R/corrcond.R")
library(data.table)
ld_matrix = as.matrix(fread("/Volumes/Elements/paintor_runs/final_regions/9_4:88710413-89316460.LD.EUR.old", header=F))
library(data.table)
ld_matrix = as.matrix(fread("/Volumes/Elements/paintor_runs/final_regions/6_4:9363105-10773602.LD.EUR.old", header=F))
frequencies = read.table("/Volumes/Elements/paintor_runs/final_regions/6_4:9363105-10773602.EUR", header=F)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af = freq_af[order(freq_af$pos),]
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
freq_af$Effect = ifelse(toupper(freq_af$Allele1) == freq_af$a1, freq_af$Effect, -freq_af$Effect)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0, var_y = 1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results
rownames(stepwise_results)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.05)
stepwise_results
as.numeric(rownames(stepwise_results))
ld_matrix[as.numeric(rownames(stepwise_results)),as.numeric(rownames(stepwise_results))]
write.table(stepwise_results$rsid, file="all_data.txt", quote = F, col.names=F, row.names=F)

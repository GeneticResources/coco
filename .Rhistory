source("R/corrcond.R")
library(data.table)
ld_matrix = as.matrix(read.table("/Volumes/Elements/paintor_runs/final_regions/0_1:145538184-145786438.LD.EUR.old", header=F))
frequencies = read.table("/Volumes/Elements/paintor_runs/final_regions/0_1:145538184-145786438.EUR", header=F)
kottgen_meta_analysis = fread("~/Dunedin/Tony/Metanalysis/input_smr.txt", header=T)
all_af = fread("/Volumes/Elements/ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/all_af.txt", header=F)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$SNP)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
stepwise_conditional_run(data_set = freq_af)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.01)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.1)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.1)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.01)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.01)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix)
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
source("R/corrcond.R")
stepwise_resurts= stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
source("R/corrcond.R")
stepwise_resurts= stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
source("R/corrcond.R")
stepwise_resurts= stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
stepwise_resurts
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
source("R/corrcond.R")
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
source("R/corrcond.R")
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
source("R/corrcond.R")
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
stepwise_resurts
rm(stepwise_resurts)
stepwise_results
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
stepwise_results
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
stepwise_results
source("R/corrcond.R")
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
write.table(ld_matrix, file="../ld_matrix_test.txt", quote=F, row.names=F, col.names=F)
write.table(freq_af,file="../snp_summary.txt", quote=F, row.names=F, col.names=T)
freq_af = read.table("../data/snp_summary.txt", header=T)
ld_matrix = read.table("../data/ld_matrix_test.txt", header=F)
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = read.table("data/ld_matrix_test.txt", header=F)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
nrow(ld_matrix)
ld_matrix
colnames(ld_matrix)
colnames(ld_matrix)
freq_af = read.table("data/snp_summary.txt", header=T)
nrow(freq_af)
nrow(ld_matrix)
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = read.table("data/ld_matrix_test.txt", header=F)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$SNP)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$SNP)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
ld_matrix = as.matrix(read.table("/Volumes/Elements/paintor_runs/final_regions/0_1:145538184-145786438.LD.EUR.old", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
isSymmetric(ld_matrix)
isSymmetric(ld_matrix)
ld_matrix
isSymmetric(as.matrix(ld_matrix))
isSymmetric(unname(as.matrix(ld_matrix)))
ld_matrix[,1]
ld_matrix[1,1]
ld_matrix[1,2]
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
ld_matrix = read.table("data/ld_matrix_test.txt", header=F)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
ld_matrix = as.matrix(read.table("/Volumes/Elements/paintor_runs/final_regions/0_1:145538184-145786438.LD.EUR.old", header=F))
write.table(ld_matrix, file="data/ld_matrix_test.txt", quote=F, row.names=F, col.names=F)
ld_matrix = read.table("data/ld_matrix_test.txt", header=F)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
ld_matrix = read.table("data/ld_matrix_test.txt", header=F)
unname(ld_matrix)
isSymmetric(unname(ld_matrix))
isSymmetric(unname(as.matrix(ld_matrix)))
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
```
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.01)
freq_af$rsid == "rs4970847"
freq_af[freq_af$rsid == "rs4970847",]
freq_af[which(freq_af$rsid == "rs4970847"),]
freq_af[which(freq_af$rsid == "rs4970847")]
freq_af[which(freq_af$rsid == "rs4970847"),]
which(freq_af$rsid == "rs4970847")
freq_af[c(47,208),]
ld_matrix[c(47,208),c(47,208) ]
ld_matrix[c(47,208),c(47,208) ]
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
stepwise_results
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
stepwise_results
which(freq_af$rsid == "rs9286836")
ld_matrix[c(61,208),c(61,208) ]
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.1)
nrow(ld_matrix)
nrow(freq_af)
source("R/corrcond.R")
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.1)
getwd()
ld_matrix = as.matrix(read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld", header=F))
isSymmetric(ld_matrix)
source("R/symmetricize.R")
source("R/symmetrcize.R")
ld_matrix = as.matrix(read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld", header=F))
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=F))
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=T))
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=T)
daner = read.table("data/daner_PGC_SCZ52_0513a_hq2-chr2_200825237_I_2merged_2_200628237_201293237.txt", header=T)
x = merge(daner,snpdat, by="SNP")
head(x)
sum(log(x$OR)/x$SE == x$Z)
length(log(x$OR)/x$SE == x$Z)
x$Zor = log(x$OR)/x$SE
head(x)
head(x[(log(x$OR)/x$SE != x$Z),]
)
summary(log(x$OR)/x$SE - x$Z)
daner_dat = merge(daner,snpdat, by="SNP")
daner_dat$b <- log(daner_dat$OR)/daner_dat$SE
daner_dat$b <- log(daner_dat$OR)
colnames(daner_dat)
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
daner_dat$se = daner_dat$se
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
colname(freq_af)
colnames(freq_af)
daner_dat$ngt
daner_dat$sum_n
daner_dat$sum_n
daner_dat$sum_n
daner_dat$n = daner_dat$sum_n
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
head(daner_dat)
daner_dat = merge(daner,snpdat, by="SNP")
daner_dat$b <- log(daner_dat$OR)
daner_dat$se = daner_dat$SE
daner_dat$n = daner_dat$sum_n
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
head(stepwise_results)
head(daner_dat)
abs(daner_dat$Z)
abs(daner_dat$Z) == max(daner_dat$Z)
which(abs(daner_dat$Z) == max(daner_dat$Z))
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
class(daner_dat)
daner_dat[1,]
daner_dat[1,]$Z
daner_dat[1,]$rsid
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
which(is.na(daner_dat$Z))
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
names(daner_dat)
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
source('~/resources/gits/coco/R/corrcond.R')
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
dim(ld_matrix)
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
warnings()
ld_matrix = symmetricize(ld_matrix)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
warnings()
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 1e-7)
ld_matrix[c(52,134),c(52,134)]
daner_dat[c(52,134),]
head(x)
x = x[order(x$BP.x),]
head(x)
daner_dat = daner_dat[order(daner_dat$BP),]
daner_dat = daner_dat[order(daner_dat$BP.x),]
head(daner_dat)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 1e-7)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 1e-5)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 1e-4)
colnames(daner_dat)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, var_y = 0.25)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 0.0001,  var_y = 0.25)

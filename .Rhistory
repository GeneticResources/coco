freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
#all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results )
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
# freq_af = merge(corr,frequencies,by=1)
freq_af = freq_af[order(freq_af$POS),]
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
m1
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="pearson")
g3 = linear_to_logistic(b = df$res_step$beta_new,df$res_step$se_new, phi=gg, theta=freq_af$FREQ1)
g = cbind(betas, g3[,1])
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="pearson")
cor(g[,1],g[,2], method="pearson")
f = (cbind(beta_unadj,betas))
f = f[!is.na(betas),]
cor(f,method  ="pearson")
# 64.5 %correlated
gg = table(dos_data$RANDOM_BIN)[1]/sum(table(dos_data$RANDOM_BIN))
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
# freq_af = merge(corr,frequencies,by=1)
freq_af = freq_af[order(freq_af$POS),]
f
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="pearson")
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="pearson")
g3 = linear_to_logistic(b = df$res_step$beta_new,df$res_step$se_new, phi=gg, theta=freq_af$FREQ1)
g = cbind(betas, g3[,1])
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="pearson")
plot(g[,1])
plot(g[,1], g[,2])
gg
gg = table(dos_data$RANDOM_BIN)[1]/sum(table(dos_data$RANDOM_BIN))
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
#all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results )
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
cor(g[,1],g[,2],method="spearman")
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
g = g[!is.na(g[,1]),]
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
# freq_af = merge(corr,frequencies,by=1)
freq_af = freq_af[order(freq_af$POS),]
f
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
cor(g[,1],g[,2], method="spearman")
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
freq_af = freq_af[order(freq_af$POS),]
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
g3 = linear_to_logistic(b = df$res_step$beta_new,df$res_step$se_new, phi=gg, theta=freq_af$FREQ1)
g = cbind(betas, g3[,1])
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="pearson")
cor(g[,1],g[,2], method="spearman")
gg = table(dos_data$RANDOM_BIN)[1]/sum(table(dos_data$RANDOM_BIN))
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
g3 = linear_to_logistic(b = df$res_step$beta_new,df$res_step$se_new, phi=gg, theta=freq_af$FREQ1)
g = cbind(betas, g3[,1])
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
g3 = linear_to_logistic(b = df$res_step$beta_new,df$res_step$se_new, phi=gg, theta=freq_af$FREQ1)
g = cbind(betas, g3[,1])
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
dos_data$RANDOM_BIN = ifelse(rbinom(n=nrow(dos_data),1,0.1), dos_data$RANDOM_BIN, 1- dos_data$RANDOM_BIN)
betas = c()
ses = c()
m1 = summary(lm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 + dos_data$rs546552))
(m1)
for(i in rsids){
m1 = summary(glm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 + dos_data[,i], family=binomial))
if (colnames(dos_data)[i] != "rs10520157"){
betas = c(betas,coef(m1)[3,1])
ses = c(ses,coef(m1)[3,2])
}else{
betas = c(betas,NA)
ses = c(ses,NA)
}
}
beta_unadj =c()
se_unadj = c()
for(i in rsids){
m1 = summary(glm(dos_data$RANDOM_BIN ~ dos_data[,i], family=binomial))
beta_unadj = c(beta_unadj,coef(m1)[2,1])
se_unadj = c(se_unadj,coef(m1)[2,2])
}
f = (cbind(beta_unadj,betas))
f = f[!is.na(betas),]
cor(f,method  ="pearson")
gg = table(dos_data$RANDOM_BIN)[1]/sum(table(dos_data$RANDOM_BIN))
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
#all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results )
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
m1
m1 = summary(lm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 + dos_data$rs546552))
(m1)
cor(g[,1],g[,2], method="spearman")
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
freq_af$Z
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
freq_af$Z
freq_af$se
freq_af$beta
freq_af$beta/freq_af$se
order(freq_af$beta/freq_af$se)
order(freq_af$beta/freq_af$se,decreasing=T)
freq_af[order(freq_af$beta/freq_af$se,decreasing=T),]
head(freq_af[order(freq_af$beta/freq_af$se,decreasing=T),])
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
gg = table(dos_data$RANDOM_BIN)[1]/sum(table(dos_data$RANDOM_BIN))
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
dos_data$RANDOM_BIN = dos_data$ENSG00000137601 > 6
dos_data$RANDOM_BIN = ifelse(rbinom(n=nrow(dos_data),1,0.8), dos_data$RANDOM_BIN, 1- dos_data$RANDOM_BIN)
betas = c()
ses = c()
m1 = summary(lm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 + dos_data$rs546552))
(m1)
dos_data$RANDOM_BIN = dos_data$ENSG00000137601 > 6
dos_data$RANDOM_BIN = ifelse(rbinom(n=nrow(dos_data),1,0.5), dos_data$RANDOM_BIN, 1- dos_data$RANDOM_BIN)
betas = c()
ses = c()
m1 = summary(lm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 + dos_data$rs546552))
(m1)
dos_data$RANDOM_BIN = dos_data$ENSG00000137601 > 6
dos_data$RANDOM_BIN = ifelse(rbinom(n=nrow(dos_data),1,1), dos_data$RANDOM_BIN, 1- dos_data$RANDOM_BIN)
betas = c()
ses = c()
m1 = summary(lm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 + dos_data$rs546552))
(m1)
dos_data$RANDOM_BIN = dos_data$ENSG00000137601 > 6
dos_data$RANDOM_BIN = ifelse(rbinom(n=nrow(dos_data),1,0.9), dos_data$RANDOM_BIN, 1- dos_data$RANDOM_BIN)
betas = c()
ses = c()
m1 = summary(lm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 + dos_data$rs546552))
(m1)
for(i in rsids){
m1 = summary(glm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 + dos_data[,i], family=binomial))
if (colnames(dos_data)[i] != "rs10520157"){
betas = c(betas,coef(m1)[3,1])
ses = c(ses,coef(m1)[3,2])
}else{
betas = c(betas,NA)
ses = c(ses,NA)
}
}
beta_unadj =c()
se_unadj = c()
for(i in rsids){
m1 = summary(glm(dos_data$RANDOM_BIN ~ dos_data[,i], family=binomial))
beta_unadj = c(beta_unadj,coef(m1)[2,1])
se_unadj = c(se_unadj,coef(m1)[2,2])
}
f = (cbind(beta_unadj,betas))
f = f[!is.na(betas),]
cor(f,method  ="pearson")
# 64.5 %correlated
gg = table(dos_data$RANDOM_BIN)[1]/sum(table(dos_data$RANDOM_BIN))
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
#all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results )
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
# freq_af = merge(corr,frequencies,by=1)
freq_af = freq_af[order(freq_af$POS),]
f
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
g3 = linear_to_logistic(b = df$res_step$beta_new,df$res_step$se_new, phi=gg, theta=freq_af$FREQ1)
g = cbind(betas, g3[,1])
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
#all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results )
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
m1 = summary(lm(dos_data$RANDOM_BIN ~ dos_data$rs10520157 ))
(m1)
exp(-0.25934 )
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = 0.670354, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
alpha = log(.67/(1-.67))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new/df$res_step$se_new, betas/ses)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
gg = table(dos_data$RANDOM_BIN)[1]/sum(table(dos_data$RANDOM_BIN))
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new/df$res_step$se_new, betas/ses)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
#all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results )
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
# freq_af = merge(corr,frequencies,by=1)
freq_af = freq_af[order(freq_af$POS),]
f
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
g3 = linear_to_logistic(b = df$res_step$beta_new,df$res_step$se_new, phi=gg, theta=freq_af$FREQ1)
g = cbind(betas/ses, g3[,1]/g3[,2])
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
gg = table(dos_data$RANDOM_BIN)[1]/sum(table(dos_data$RANDOM_BIN))
freq_af$beta = beta_unadj
freq_af$se = se_unadj
freq_af$Z =  beta_unadj/se_unadj
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = T)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-4,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new/df$res_step$se_new, betas/ses)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
g = cbind(df$res_step$beta_new/df$res_step$se_new, betas/ses)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
#all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results )
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
g = cbind(df$res_step$beta_new/df$res_step$se_new, betas/ses)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2],method="spearman")
summary(lm(g[,2] ~ g[,1]))
# freq_af = merge(corr,frequencies,by=1)
freq_af = freq_af[order(freq_af$POS),]
f
new_betas = logistic_to_linear(b = freq_af$beta, freq_af$Z,phi = gg, ref_af=freq_af$FREQ1)
freq_af$beta =  new_betas[,1]
freq_af$se = new_betas[,2]
freq_af$Z = freq_af$beta/freq_af$se
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,hwe_variance = F)
stepwise_results2 = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 9.186111e-06,colinear_threshold = 0.9)
df = conditional_from_ids(rsids = "rs10520157", res_preparation)
g = cbind(df$res_step$beta_new, betas)
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")
g3 = linear_to_logistic(b = df$res_step$beta_new,df$res_step$se_new, phi=gg, theta=freq_af$FREQ1)
g = cbind(betas/ses, g3[,1]/g3[,2])
g = g[!is.na(g[,1]),]
cor(g[,1],g[,2], method="spearman")

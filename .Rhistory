freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
freq_af$n = freq_af$TotalSampleSize
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-4,var_y = 1.6421)
nrow(freq_af)
freq_af$n
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-4,var_y = 1.6421)
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
data_set$se
freq_af$StdErr
freq_af$b = freq_af$Effect
kottgen_meta_analysis = fread("~/Dunedin/Tony/Metanalysis/input_smr.txt", header=T)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$MarkerName)
#freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
nrow(freq_af)
freq_af = merge(frequencies,all_af,by.x=3,by.y=1)
nrow(freq_af)
colnames(freq_af) = c("rsid","chr","pos","Z","chr1","pos1","a1","a2","pop1","af")
freq_af$af = as.numeric(freq_af$af)
idxs_with_betas = which(freq_af$rsid %in% kottgen_meta_analysis$SNP)
ld_matrix = as.matrix(read.table("/Volumes/Elements/paintor_runs/final_regions/11_5:72375077-72506696.LD.EUR.old", header=F))
ld_matrix= ld_matrix[idxs_with_betas,idxs_with_betas]
freq_af = freq_af[idxs_with_betas,]
freq_af = merge(freq_af,kottgen_meta_analysis,by=1)
freq_af = freq_af[order(freq_af$pos),]
nrow(freq_af)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-4,var_y = 1.6421)
df$rsid
ld_matrix[c(105,132),c(105,132)]
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df
plot(abs(all_but_one_df[[1]]$beta_old/all_but_one_df[[1]]$se_old))
plot(abs(all_but_one_df[[2]]$beta_old/all_but_one_df[[2]]$se_old))
plot(abs(all_but_one_df[[3]]$beta_old/all_but_one_df[[3]]$se_old))
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]$se_new))
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]]$se_new))
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]$se_new))
stepwise_results
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]$se_new))
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]$se_new))
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]$se_new))
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df[[1]] [c(105,132),]
all_but_one_df[[2]] [c(105,132),]
all_but_one_df[[1]] [c(105,132),]
all_but_one_df[[2]] [c(105,132),]
all_but_one_df[[1]] [c(105,132),]
all_but_one_df[[2]] [c(105,132),]
all_but_one_df[[1]] [c(105,132),]
all_but_one_df[[2]] [c(105,132),]
all_but_one_df[[1]] [c(105,132),]
all_but_one_df[[2]] [c(105,132),]
0.03307978/0.006262689
2*pnorm(abs(0.03307978/0.006262689), lower.tail = F)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-4,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]$se_new))
stepwise_results
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]$se_new))
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]$se_new))
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[3]]$beta_new/all_but_one_df[[3]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new))
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[2]]$beta_new/all_but_one_df[[2]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
identity()
identity(1)
identity(nrow(ld_matrix))
identity(x =c(1,333))
diag(x=c(1,333))
diag(x=rep(1,333))
(x=rep(1,333))
diag(x=c(1,333)) + ld_matrix
diag(x=c(1,333))*0.1
diag((x=rep(1,333)) * 0.1)
diag((x=rep(1,333)) * 0.1) + ld_matrix
diag((x=rep(1,333)) * 0.1) %+% ld_matrix
mps[cbind(1:n,1:n)]
ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))]
ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))] + .1
ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))]  = ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))] + .1
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/.active-rstudio-document', echo=TRUE)
ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))] - .1
ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))]
ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))]  = ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))] -.1
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))]  = ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))] + .2
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
ld_matrix[cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))]
stepwise_results
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_conditional_wrapper(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421, ld_noise=0.1)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
stepwise_results = stepwise_conditional_run(data_set = ld_matrix, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
stepwise_results = stepwise_conditional_run(data_set = ld_matrix, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/.active-rstudio-document', echo=TRUE)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
dim(ld_matrix)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]$se_new))
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]$se_new))
all_but_one()
all_but_one_df
all_but_one_df[[1]]
stepwise_results
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]$se_new))
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = ld_matrix, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
freq_af$rsid
source('~/Sinai/corrcond/R/corrcond.R')
data_set
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_conditional_wrapper(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421, ld_noise=0.1)
stepwise_results = stepwise_conditional_run(data_set = ld_matrix, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
res_preparation = prep_dataset_common(data_set = data_set,ld_matrix= ld_matrix,ld_noise=0.1)
source('~/.active-rstudio-document', echo=TRUE)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = data_set,ld_matrix= ld_matrix,ld_noise=0.1)
nrow(data_set)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
source('~/.active-rstudio-document', echo=TRUE)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
res_preparation$data_set
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
res_preparation$ld_matrix
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
dim(res_preparation$data_set)
res_preparation$data_set$pos
order(res_preparation$data_set$pos)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
ld_matrix
diag(ld_matrix)
diag(ld_matrix)
cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))
cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))
source('~/Sinai/corrcond/R/corrcond.R')
cbind(1:nrow(ld_matrix),1:nrow(ld_matrix))
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
ld_matrix[,1]
ld_matrix[1,1]
ld_matrix = as.matrix(read.table("/Volumes/Elements/paintor_runs/final_regions/11_5:72375077-72506696.LD.EUR.old", header=F))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
res_preparation
res_preparation$ld_matrix
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/.active-rstudio-document', echo=TRUE)
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/.active-rstudio-document', echo=TRUE)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
?message
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df[[1]]
all_but_one_df
all_but_one_df
lapply(all_but_one,function(x)x[2])
lapply(all_but_one,function(x) x[2])
lapply(all_but_one_df,function(x) x[2])
lapply(all_but_one_df,function(x))
lapply(all_but_one_df,function(x) x[[2]])
lapply(all_but_one_df,function(x) x[,2])
lapply(all_but_one_df,function(x) x[1])
lapply(all_but_one_df,function(x) x[[2]])
lapply(all_but_one_df,function(x) x$res_step)
lapply(all_but_one_df,function(x) x$res_step)
all_but_one_df
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-4,var_y = 1.6421)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-4,var_y = 1.6421)
all_but_one_df = all_but_one(data_set =freq_af, ld_matrix = ld_matrix,stepwise_results = stepwise_results ,var_y=1.6421)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df
source('~/Sinai/corrcond/R/corrcond.R')
c(1,2,3)
c(1,2,3) - c(2,3)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df
source("R/symmetrcize.R")
ld_matrix = as.matrix(read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld", header=F))
ld_matrix = symmetricize(ld_matrix)
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=T)
daner_dat = merge(daner,snpdat, by="SNP")
daner_dat$se = daner_dat$SE
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
daner = read.table("data/daner_PGC_SCZ52_0513a_hq2-chr2_200825237_I_2merged_2_200628237_201293237.txt", header=T)
daner_dat$n = daner_dat$sum_n
daner_dat$b <- log(daner_dat$OR)
daner_dat = daner_dat[order(daner_dat$BP.x),]
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
all_but_one_df
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_old/all_but_one_df[[1]]$se_old) ~ daner_dat$BP.x)
plot(abs(all_but_one_df[[2]]$beta_old/all_but_one_df[[2]]$se_old) ~ daner_dat$BP.x)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df$main_hit)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[1]]$main_hit)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df$main_hit)
all_but_one_df[[1]]
all_but_one_df[[2]]
all_but_one_df[[3]]
all_but_one_df[[4]]
all_but_one_df[[5]]
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =daner_dat, ld_matrix = ld_matrix, stepwise_results = stepwise_resultsd ,var_y=3.7288262)
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
all_but_one_df
all_but_one_df[[1]]
all_but_one_df[[1]]
all_but_one_df[[1]][,1]
all_but_one_df[[1]]
all_but_one_df[[1]]
all_but_one_df[[1]][[1]]
all_but_one_df[[2]]
all_but_one_df[[2]]$res_step
all_but_one_df[[2]]$main_hit
all_but_one_df[[2]]$main_hit
all_but_one_df[[3]]
all_but_one_df[[2]]
stepwise_results
<<<<<<< HEAD
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
stepwise_results
which(freq_af$rsid == "rs9286836")
ld_matrix[c(61,208),c(61,208) ]
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.0001)
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.001)
source("R/corrcond.R")
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.1)
nrow(ld_matrix)
nrow(freq_af)
source("R/corrcond.R")
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 0.1)
getwd()
ld_matrix = as.matrix(read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld", header=F))
isSymmetric(ld_matrix)
source("R/symmetricize.R")
source("R/symmetrcize.R")
ld_matrix = as.matrix(read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld", header=F))
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=F))
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=T))
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=T)
daner = read.table("data/daner_PGC_SCZ52_0513a_hq2-chr2_200825237_I_2merged_2_200628237_201293237.txt", header=T)
x = merge(daner,snpdat, by="SNP")
head(x)
sum(log(x$OR)/x$SE == x$Z)
length(log(x$OR)/x$SE == x$Z)
x$Zor = log(x$OR)/x$SE
head(x)
head(x[(log(x$OR)/x$SE != x$Z),]
)
summary(log(x$OR)/x$SE - x$Z)
daner_dat = merge(daner,snpdat, by="SNP")
daner_dat$b <- log(daner_dat$OR)/daner_dat$SE
daner_dat$b <- log(daner_dat$OR)
colnames(daner_dat)
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
daner_dat$se = daner_dat$se
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
colname(freq_af)
colnames(freq_af)
daner_dat$ngt
daner_dat$sum_n
daner_dat$sum_n
daner_dat$sum_n
daner_dat$n = daner_dat$sum_n
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
head(daner_dat)
daner_dat = merge(daner,snpdat, by="SNP")
daner_dat$b <- log(daner_dat$OR)
daner_dat$se = daner_dat$SE
daner_dat$n = daner_dat$sum_n
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
head(stepwise_results)
head(daner_dat)
abs(daner_dat$Z)
abs(daner_dat$Z) == max(daner_dat$Z)
which(abs(daner_dat$Z) == max(daner_dat$Z))
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
class(daner_dat)
daner_dat[1,]
daner_dat[1,]$Z
daner_dat[1,]$rsid
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
which(is.na(daner_dat$Z))
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
names(daner_dat)
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
source('~/resources/gits/coco/R/corrcond.R')
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
dim(ld_matrix)
source('~/resources/gits/coco/R/corrcond.R')
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
warnings()
ld_matrix = symmetricize(ld_matrix)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix)
warnings()
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 1e-7)
ld_matrix[c(52,134),c(52,134)]
daner_dat[c(52,134),]
head(x)
x = x[order(x$BP.x),]
head(x)
daner_dat = daner_dat[order(daner_dat$BP),]
daner_dat = daner_dat[order(daner_dat$BP.x),]
head(daner_dat)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 1e-7)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 1e-5)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 1e-4)
colnames(daner_dat)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, var_y = 0.25)
stepwise_results = stepwise_conditional_run(data_set = daner_dat, ld_matrix = ld_matrix, p_value_threshold = 0.0001,  var_y = 0.25)
=======
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
all_but_one_df
all_but_one_df[[1]]
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[1]]$main_hit)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[1]]$main_hit)
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[1]]$main_hit)
plot(abs(all_but_one_df[[2]]$res_step$beta_new/all_but_one_df[[2]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[2]]$main_hit)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit)
plot(abs(all_but_one_df[[4]]$res_step$beta_new/all_but_one_df[[4]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[4]]$main_hit)
plot(abs(aner_dat$b/daner$SE))
plot(abs(aner_dat$b/daner$se ~ daner_dat$BP.x)
plot(abs(aner_dat$b/daner$se) ~ daner_dat$BP.x)
plot(abs(daner_dat$b/daner$se) ~ daner_dat$BP.x)
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x)
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
plot(abs(all_but_one_df[[4]]$res_step$beta_new/all_but_one_df[[4]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[4]]$main_hit)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit)
par(mfrow=c(2,1))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit)
par(mfrow=c(1,2))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit)
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
library(data.table)
ld_matrix = as.matrix(read.table("/Volumes/Elements/paintor_runs/final_regions/11_5:72375077-72506696.LD.EUR.old", header=F))
stepwise_conditional_wrapper(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421, ld_noise=0.1)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[2]]$res_step$beta_new/all_but_one_df[[2]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[2]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[2]]$res_step$beta_new/all_but_one_df[[2]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[2]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[1]]$main_hit,ylim=c(0,10))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[1]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[1]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[2]]$res_step$beta_new/all_but_one_df[[2]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[2]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[1]]$main_hit,ylim=c(0,10))
>>>>>>> c8bdafb5a14e2256f54edbb8d05e67dc7625c1d3

stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df
source("R/symmetrcize.R")
ld_matrix = as.matrix(read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld", header=F))
ld_matrix = symmetricize(ld_matrix)
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=T)
daner_dat = merge(daner,snpdat, by="SNP")
daner_dat$se = daner_dat$SE
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
daner = read.table("data/daner_PGC_SCZ52_0513a_hq2-chr2_200825237_I_2merged_2_200628237_201293237.txt", header=T)
daner_dat$n = daner_dat$sum_n
daner_dat$b <- log(daner_dat$OR)
daner_dat = daner_dat[order(daner_dat$BP.x),]
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
all_but_one_df
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new)  ~ freq_af$pos)
plot(abs(all_but_one_df[[1]]$beta_old/all_but_one_df[[1]]$se_old) ~ daner_dat$BP.x)
plot(abs(all_but_one_df[[2]]$beta_old/all_but_one_df[[2]]$se_old) ~ daner_dat$BP.x)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df$main_hit)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[1]]$main_hit)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df$main_hit)
all_but_one_df[[1]]
all_but_one_df[[2]]
all_but_one_df[[3]]
all_but_one_df[[4]]
all_but_one_df[[5]]
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =daner_dat, ld_matrix = ld_matrix, stepwise_results = stepwise_resultsd ,var_y=3.7288262)
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
all_but_one_df
all_but_one_df[[1]]
all_but_one_df[[1]]
all_but_one_df[[1]][,1]
all_but_one_df[[1]]
all_but_one_df[[1]]
all_but_one_df[[1]][[1]]
all_but_one_df[[2]]
all_but_one_df[[2]]$res_step
all_but_one_df[[2]]$main_hit
all_but_one_df[[2]]$main_hit
all_but_one_df[[3]]
all_but_one_df[[2]]
stepwise_results
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
all_but_one_df
all_but_one_df[[1]]
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[1]]$main_hit)
plot(abs(all_but_one_df[[1]]$beta_new/all_but_one_df[[1]]$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[1]]$main_hit)
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[1]]$main_hit)
plot(abs(all_but_one_df[[2]]$res_step$beta_new/all_but_one_df[[2]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[2]]$main_hit)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit)
plot(abs(all_but_one_df[[4]]$res_step$beta_new/all_but_one_df[[4]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[4]]$main_hit)
plot(abs(aner_dat$b/daner$SE))
plot(abs(aner_dat$b/daner$se ~ daner_dat$BP.x)
plot(abs(aner_dat$b/daner$se) ~ daner_dat$BP.x)
plot(abs(daner_dat$b/daner$se) ~ daner_dat$BP.x)
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x)
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
plot(abs(all_but_one_df[[4]]$res_step$beta_new/all_but_one_df[[4]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[4]]$main_hit)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit)
par(mfrow=c(2,1))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit)
par(mfrow=c(1,2))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit)
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,xlim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(daner_dat$b/daner_dat$se) ~ daner_dat$BP.x,ylim=c(0,10))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
library(data.table)
ld_matrix = as.matrix(read.table("/Volumes/Elements/paintor_runs/final_regions/11_5:72375077-72506696.LD.EUR.old", header=F))
stepwise_conditional_wrapper(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-3,var_y = 1.6421, ld_noise=0.1)
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ daner_dat$BP.x, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[3]]$res_step$beta_new/all_but_one_df[[3]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[3]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[2]]$res_step$beta_new/all_but_one_df[[2]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[2]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[2]]$res_step$beta_new/all_but_one_df[[2]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[2]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[1]]$main_hit,ylim=c(0,10))
res_preparation = prep_dataset_common(data_set = freq_af,ld_matrix= ld_matrix,ld_noise=0.1)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 1.6421)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=1.6421)
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[1]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[1]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[2]]$res_step$beta_new/all_but_one_df[[2]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[2]]$main_hit,ylim=c(0,10))
plot(abs(all_but_one_df[[1]]$res_step$beta_new/all_but_one_df[[1]]$res_step$se_new) ~ freq_af$pos, main=all_but_one_df[[1]]$main_hit,ylim=c(0,10))
source("R/corrcond.R")
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-4,var_y = 1.6421)
freq_af = read.table("data/snp_summary.txt", header=T)
ld_matrix = as.matrix(read.table("data/ld_matrix_test.txt", header=F))
stepwise_results = stepwise_conditional_run(data_set = freq_af, ld_matrix=ld_matrix,p_value_threshold = 1e-4,var_y = 1.6421)
source("R/corrcond.R")
library(data.table)
source("R/corrcond.R")
library(data.table)
daner_dat
source("R/symmetrcize.R")
ld_matrix = as.matrix(read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld", header=F))
ld_matrix = symmetricize(ld_matrix)
snpdat = read.table("data/chr2_200825237_I_2merged_2_200628237_201293237.ld.snpdat", header=T)
daner = read.table("data/daner_PGC_SCZ52_0513a_hq2-chr2_200825237_I_2merged_2_200628237_201293237.txt", header=T)
daner_dat = merge(daner,snpdat, by="SNP")
daner_dat$b <- log(daner_dat$OR)
daner_dat$se = daner_dat$SE
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
daner_dat$n = daner_dat$sum_n
daner_dat = daner_dat[order(daner_dat$BP.x),]
r =  r(daner_dat$b ,0.5,daner_dat$af)
r =  function(gamma,phi,theta){
r = gamma/(((phi*(1-phi)) + 0.5*(1-2*phi) * (1 - 2*theta) * gamma) - (0.084 + 0.9 * phi * (1-2 * phi) * theta * (1-theta)) /(phi*(1-phi))* gamma^2)
r
}
r =  r(daner_dat$b ,0.5,daner_dat$af)
r
r_inverse= function(gamma,phi,ref_af){
B =  (0.5*(1-2*phi) * (1 - 2*ref_af) * gamma -1)
A = - (0.084 + 0.9 * phi * (1-2 * phi) * ref_af * (1-ref_af)) * gamma
C = gamma
x1 = (-B+ sqrt( B^2 - 4 * A * C  ))/(2*A)
x2 = (-B - sqrt( B^2 - 4 * A * C  ))/(2*A)
return(c(x1,x2))
}
r =  r_inverse(daner_dat$b ,0.5,daner_dat$af)
u = 0.5
alpha = log(u/(1-u))
r
r =  r_inverse(daner_dat$b ,0.5,daner_dat$af)
r
r
r[,1]
r[seq(1,by=2,to = nrow(daner_dat))]
r[seq(2,by=2,to = nrow(daner_dat))]
r[seq(1,by=2,to = nrow(daner_dat))]
r_inverse= function(gamma,phi,ref_af){
B =  (0.5*(1-2*phi) * (1 - 2*ref_af) * gamma -1)
A = - (0.084 + 0.9 * phi * (1-2 * phi) * ref_af * (1-ref_af)) * gamma
C = gamma
x1 = (-B+ sqrt( B^2 - 4 * A * C  ))/(2*A)
x2 = (-B - sqrt( B^2 - 4 * A * C  ))/(2*A)
return(cbind(x1,x2))
}
r =  r_inverse(daner_dat$b ,0.5,daner_dat$af)
r
r[,1]
r[,2]
gammas = r[,2]
u = 0.5
alpha = log(u/(1-u))
gammas * exp(alpha) / ((1+exp(alpha))^2)
cbind(gammas,daner_dat$b)
cbind(gammas,daner_dat$b)
daner_dat$b
cbind(gammas,daner_dat$b)
daner_dat$b
r =  r_inverse(daner_dat$b ,0.2,daner_dat$af)
r
daner_dat$b
r
daner_dat$b
r
daner_dat$b
log(u/(1-u))
u
log(u/(1-u))
u = 0.2
alpha = log(u/(1-u))
aplha
alpha
u = 0.4
alpha = log(u/(1-u))
alpha
r(daner_dat$b,phi = 0.5,daner_dat$af)
r =  function(gamma,phi,theta){
r = gamma/(((phi*(1-phi)) + 0.5*(1-2*phi) * (1 - 2*theta) * gamma) - (0.084 + 0.9 * phi * (1-2 * phi) * theta * (1-theta)) /(phi*(1-phi))* gamma^2)
r
}
r(daner_dat$b,phi = 0.5,daner_dat$af)
daner_dat$b
r(daner_dat$b,phi = 0.5,daner_dat$af)
daner_dat$b
r(daner_dat$b,phi = 0.5,daner_dat$af)
daner_dat$b
log(u/(1-u))
log(0.5/(1-.5))
exp(alpha) / ((1+exp(alpha))^2)
#
exp(alpha) / ((1+exp(alpha))^2)
gammas * exp(alpha) / ((1+exp(alpha))^2)
gammas * exp(alpha) / ((1+exp(alpha))^2)
daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
gammas * exp(alpha) / ((1+exp(alpha))^2)
daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
beta = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
beta
2*(daner_dat$af)
2*(daner_dat$af) * (1 - daner_dat$af)
2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$n
2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x))
2.044e-01
r =  r_inverse(daner_dat$b ,0.2,daner_dat$af)
r[,2]
r[,2]
r[,2] - daner_dat$b
r[,2] - daner_dat$b
plot(r[,2] - daner_dat$b)
plot(r[,2] - daner_dat$b)
plot(r[,2] - daner_dat$b)
plot(r[,2] - daner_dat$se)
plot(r[,2] - daner_dat$b)
plot(r[,2] - daner_dat$b)
plot(r[,2] - daner_dat$se)
plot(r[,2] - daner_dat$b)
r(daner_dat$b,phi = 0.5,daner_dat$af)
gammas = r[,2]
r =  r_inverse(daner_dat$b ,0.2,daner_dat$af)
r(daner_dat$b,phi = 0.5,daner_dat$af)
r =  function(gamma,phi,theta){
r = gamma/(((phi*(1-phi)) + 0.5*(1-2*phi) * (1 - 2*theta) * gamma) - (0.084 + 0.9 * phi * (1-2 * phi) * theta * (1-theta)) /(phi*(1-phi))* gamma^2)
r
}
r(daner_dat$b,phi = 0.5,daner_dat$af)
.3 * (1-.3)
r =  r_inverse(daner_dat$b ,0.2,daner_dat$af)
gammas = r[,2]
u = 0.3
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
beta = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
plot(r[,2] - daner_dat$se)
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x))
r =  r_inverse(daner_dat$b ,0.156,daner_dat$af)
gammas = r[,2]
u = 0.156
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
beta = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
6.297e-02
6.297e-02
6.297e-02
r =  r_inverse(daner_dat$b ,0.5,daner_dat$af)
r(daner_dat$b,phi = 0.5,daner_dat$af)
gammas = r[,2]
u = 0.5
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
beta = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
0.227020
daner_dat$n = daner_dat$sum_n
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
daner_dat = daner_dat[order(daner_dat$BP.x),]
r =  r_inverse(daner_dat$b ,0.5,daner_dat$af)
r(daner_dat$b,phi = 0.5,daner_dat$af)
gammas = r[,2]
u = 0.5
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
beta = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
r =  function(gamma,phi,theta){
r = gamma/(((phi*(1-phi)) + 0.5*(1-2*phi) * (1 - 2*theta) * gamma) - (0.084 + 0.9 * phi * (1-2 * phi) * theta * (1-theta)) /(phi*(1-phi))* gamma^2)
r
}
r(daner_dat$b,phi = 0.5,daner_dat$af)
gammas = r2[,2]
u = 0.5
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
beta = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
r(gamma,phi = 0.5, theta = daner_dat$af)
daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af)
plot(daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af))
plot(daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af))
plot(daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af))
plot(daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af))
gamma/(((phi*(1-phi))
gamma
gamma/((0.5*(1-0.5)))
install.packages("mprf")
install.packages("Rmprf")
library("Rmprf")
library("Rmprf")
options(digits=20)
r[,1]
(daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af)
daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af
daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af)
daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af)
cbind(daner_dat$b ,r(gamma,phi = 0.5, theta = daner_dat$af))
daner_dat$FRQ_A_35476/daner_dat$FRQ_U_46839
daner_dat$FRQ_A_35476/daner_dat$FRQ_U_46839
35476 /(46839 + 35476)
plot(daner_dat$b - r(gamma,phi = 0.5, theta = daner_dat$af))
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
35476 /(46839 + 35476)
u = 0.43097855797849721204
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
linear_ses = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
linear_ses
linear_ses
linear_ses
linear_ses = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
0.2270194698296115476
r2
r2 =  r_inverse(daner_dat$b ,0.5,daner_dat$af)
r(daner_dat$b,phi = 0.5,daner_dat$af)
gammas = r2[,2]
gammas
rs
r2
u = 0.43097855797849721204
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
linear_ses = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
gammas
gammas
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
r2 =  r_inverse(daner_dat$b ,u,daner_dat$af)
r(daner_dat$b,phi =u,daner_dat$af)
gammas = r2[,2]
u = 0.43097855797849721204
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
linear_ses = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
colnames(daner_dat)[c(1,20,21)] = c("rsid","af","info")
daner_dat = daner_dat[order(daner_dat$BP.x),]
r2 =  r_inverse(daner_dat$b ,u,daner_dat$af)
r(daner_dat$b,phi =u,daner_dat$af)
gammas = r2[,2]
nrow(daner_dat)
u = 0.43097855797849721204
r2 =  r_inverse(daner_dat$b ,u,daner_dat$af)
r(daner_dat$b,phi =u,daner_dat$af)
gammas = r2[,2]
alpha = log(u/(1-u))
gamma = gammas * exp(alpha) / ((1+exp(alpha))^2)
linear_ses = daner_dat$se * exp(alpha) / ((1+exp(alpha))^2)
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/beta^2
summary(lm(y ~ x - 1))
y = 2*(daner_dat$af) * (1 - daner_dat$af) * daner_dat$sum_n
x = 1/linear_ses^2
summary(lm(y ~ x - 1))
options(digits = 3)
summary(lm(y ~ x - 1))
var_y
numeric()
length(numeric())
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
colnames(daner_dat)[2]
colnames(daner_dat)[2] = "pos"
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
daner_dat$se
r2
r2
daner_dat$se
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
daner_dat$se
daner_dat$se
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
daner_dat$se
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0)
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
res_preparation
res_preparation$data_set
res_preparation$data_set
res_preparation$data_set$rsid
res_preparation$data_set$neff
plot(res_preparation$data_set$neff,res_preparation$data_set$n)
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
res_preparation$data_set
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(data_set =daner_dat, ld_matrix = ld_matrix, stepwise_results = stepwise_resultsd ,var_y=3.7288262)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
source('~/.active-rstudio-document', echo=TRUE)
source('~/Sinai/corrcond/R/corrcond.R')
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
source('~/Sinai/corrcond/R/corrcond.R')
res_preparation = prep_dataset_common(data_set = daner_dat,ld_matrix= ld_matrix,ld_noise=0, var_y = 3.7288262)
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
all_but_one_df = all_but_one(res_preparation=res_preparation,stepwise_results = stepwise_results ,var_y=3.7288262)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_conditional_wrapper(daner_dat,ld_matrix)
source('~/.active-rstudio-document', echo=TRUE)
stepwise_conditional_wrapper(data_set = daner_dat,ld_matrix = ld_matrix)
stepwise_conditional_wrapper(data_set = daner_dat,ld_matrix = ld_matrix)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
stepwise_results = stepwise_conditional_run(res_preparation = res_preparation,p_value_threshold = 1e-3,var_y = 3.7288262)
stepwise_conditional_wrapper(data_set = daner_dat,ld_matrix = ld_matrix)
wrap_function = stepwise_conditional_wrapper(data_set = daner_dat,ld_matrix = ld_matrix)
source('~/Sinai/corrcond/R/corrcond.R')
source('~/Sinai/corrcond/R/corrcond.R')
source("R/corrcond.R")
library(data.table)
ld_matrix = as.matrix(read.table("/Volumes/Elements/paintor_runs/final_regions/11_5:72375077-72506696.LD.EUR.old", header=F))
frequencies = read.table("/Volumes/Elements/paintor_runs/final_regions/11_5:72375077-72506696.EUR", header=F)
-0.009888/.0107
-0.009888/.0107
-0.009888/.0107
-0.009888/.00107
-0.002888/.0019
-0.002000/.0019
0.0099/.007
0.0099/.007
0.0099/.007
0.024/.003
0.009/.007
-0.014/.002
-0.014/.00262
